<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker - Build Better Habits</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Navigation Header -->
        <header class="nav-header">
            <div class="nav-container">
                <div class="nav-brand">
                    <h1>üìä Habit Tracker</h1>
                </div>
                <nav class="nav-tabs">
                    <button class="nav-tab active" data-page="habits">
                        <span class="nav-icon">üìÖ</span>
                        <span class="nav-text">Habits</span>
                    </button>
                    <button class="nav-tab" data-page="dashboard">
                        <span class="nav-icon">üìà</span>
                        <span class="nav-text">Dashboard</span>
                    </button>
                    <button class="nav-tab" data-page="settings">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span class="nav-text">Settings</span>
                    </button>
                </nav>
                <button class="mobile-menu-toggle" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Habits Page -->
            <section id="habits-page" class="page active">
                <div class="page-header">
                    <h2>Habit Tracking</h2>
                    <p>Build consistency with daily habit tracking</p>
                    <div class="current-date" id="current-date"></div>
                </div>
                
                <div class="habits-container">
                    <div class="habits-list">
                        <h3>Today's Habits</h3>
                        <div id="habits-grid" class="habits-grid">
                            <!-- Habits will be dynamically inserted here -->
                        </div>
                        <button id="add-habit-btn" class="btn-primary">+ Add New Habit</button>
                    </div>
                    
                    <div class="habit-matrix-section">
                        <div class="matrix-header">
                            <h3>Habit Matrix</h3>
                            <div class="matrix-controls">
                                <div class="toggle-group">
                                    <button class="toggle-btn active" data-period="week">Week</button>
                                    <button class="toggle-btn" data-period="month">Month</button>
                                </div>
                            </div>
                        </div>
                        <div id="habit-matrix" class="habit-matrix">
                            <!-- Habit matrix will be rendered here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Page -->
            <section id="dashboard-page" class="page">
                <div class="page-header">
                    <h2>Progress Dashboard</h2>
                    <p>Track your habit formation and improvement trends</p>
                </div>

                <div class="dashboard-container">
                    <!-- KPI Section -->
                    <div class="kpi-section">
                        <h3>Key Performance Indicators</h3>
                        <div class="kpi-grid">
                            <div class="kpi-card">
                                <div class="kpi-value" id="current-streak">0</div>
                                <div class="kpi-label">Current Streak</div>
                                <div class="kpi-trend" id="streak-trend">‚Üí</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="completion-rate">0%</div>
                                <div class="kpi-label">Completion Rate</div>
                                <div class="kpi-trend" id="completion-trend">‚Üí</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="total-habits">0</div>
                                <div class="kpi-label">Active Habits</div>
                                <div class="kpi-trend" id="habits-trend">‚Üí</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="best-streak">0</div>
                                <div class="kpi-label">Best Streak</div>
                                <div class="kpi-trend" id="best-trend">üèÜ</div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Overview Section -->
                    <div class="activity-section">
                        <h3>Activity Overview</h3>
                        <div class="activity-controls">
                            <select id="year-selector" class="year-selector">
                                <!-- Years will be populated dynamically -->
                            </select>
                        </div>
                        <div id="activity-grid" class="activity-grid">
                            <!-- GitHub-style activity grid will be rendered here -->
                        </div>
                        <div class="activity-legend">
                            <span class="legend-label">Less</span>
                            <div class="legend-levels">
                                <div class="legend-level level-0"></div>
                                <div class="legend-level level-1"></div>
                                <div class="legend-level level-2"></div>
                                <div class="legend-level level-3"></div>
                                <div class="legend-level level-4"></div>
                            </div>
                            <span class="legend-label">More</span>
                        </div>
                    </div>

                    <!-- Time Period Filters -->
                    <div class="time-filters">
                        <button class="filter-btn active" data-period="week">Week</button>
                        <button class="filter-btn" data-period="month">Month</button>
                        <button class="filter-btn" data-period="year">Year</button>
                    </div>

                    <!-- Charts Section -->
                    <div class="charts-section">
                        <div class="chart-container">
                            <h3>Habit Completion Trends</h3>
                            <canvas id="trends-chart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Habit Distribution <span class="info-icon" title="Shows how your daily completion rates are distributed across different percentage ranges. Helps you see consistency patterns - are you mostly in the high ranges (good consistency) or spread across lower ranges (needs improvement)?">‚ìò</span></h3>
                            <canvas id="distribution-chart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Weekly Progress</h3>
                            <canvas id="weekly-chart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section id="settings-page" class="page">
                <div class="page-header">
                    <h2>Settings</h2>
                    <p>Manage your habits and preferences</p>
                </div>

                <div class="settings-container">
                    <!-- Habit Management -->
                    <div class="settings-section">
                        <h3>Habit Management</h3>
                        <div id="habits-list" class="settings-habits-list">
                            <!-- Habits will be listed here with edit/delete options -->
                        </div>
                        <button id="add-new-habit" class="btn-primary">+ Add New Habit</button>
                    </div>

                    <!-- Add/Edit Habit Form -->
                    <div id="habit-form-container" class="settings-section hidden">
                        <h3 id="form-title">Add New Habit</h3>
                        <form id="habit-form" class="habit-form">
                            <div class="form-group">
                                <label for="habit-name">Habit Name *</label>
                                <input type="text" id="habit-name" required maxlength="50">
                            </div>
                            
                            <div class="form-group">
                                <label for="habit-description">Description</label>
                                <textarea id="habit-description" maxlength="200"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="habit-start-date">Start Date</label>
                                <input type="date" id="habit-start-date" max="">
                                <small class="form-help">When to start tracking this habit (defaults to today)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="habit-color">Color Theme</label>
                                <div class="color-picker">
                                    <input type="radio" name="color" value="#58a6ff" id="color-blue" checked>
                                    <label for="color-blue" class="color-option" style="background: #58a6ff"></label>
                                    
                                    <input type="radio" name="color" value="#3fb950" id="color-green">
                                    <label for="color-green" class="color-option" style="background: #3fb950"></label>
                                    
                                    <input type="radio" name="color" value="#d29922" id="color-yellow">
                                    <label for="color-yellow" class="color-option" style="background: #d29922"></label>
                                    
                                    <input type="radio" name="color" value="#f85149" id="color-red">
                                    <label for="color-red" class="color-option" style="background: #f85149"></label>
                                    
                                    <input type="radio" name="color" value="#a371f7" id="color-purple">
                                    <label for="color-purple" class="color-option" style="background: #a371f7"></label>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">Save Habit</button>
                                <button type="button" id="cancel-form" class="btn-secondary">Cancel</button>
                            </div>
                        </form>
                    </div>

                    <!-- Demo Mode -->
                    <div class="settings-section">
                        <h3>Demo Mode</h3>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="demo-mode">
                                <span class="checkmark"></span>
                                Enable Demo Mode
                            </label>
                            <small class="form-help">Generate sample habits and data for the past year to see how the app looks with usage</small>
                        </div>
                        <div id="demo-actions" class="data-actions" style="display: none;">
                            <div id="enter-demo-actions">
                                <p style="margin-bottom: 12px; color: var(--text-secondary); font-size: 14px;">
                                    <strong>Current data will be saved and restored when you exit demo mode.</strong>
                                </p>
                                <button id="enter-demo-mode" class="btn-primary">üé≤ Enter Demo Mode</button>
                            </div>
                            <div id="demo-mode-actions" style="display: none;">
                                <p style="margin-bottom: 12px; color: var(--accent-primary); font-size: 14px;">
                                    <strong>‚ú® Demo mode is active - your original data is safely saved</strong>
                                </p>
                                <button id="regenerate-demo-data" class="btn-secondary">üîÑ Regenerate Demo Data</button>
                                <button id="exit-demo-mode" class="btn-primary">üö™ Exit Demo Mode</button>
                            </div>
                        </div>
                    </div>

                    <!-- Help & Documentation -->
                    <div class="settings-section">
                        <h3>Help & Documentation</h3>
                        <button id="show-help" class="btn-secondary">üìñ View Help Guide</button>
                    </div>

                    <!-- Data Management -->
                    <div class="settings-section">
                        <h3>Data Management</h3>
                        <div class="data-actions">
                            <button id="export-data" class="btn-secondary">üì• Export Data</button>
                            <button id="import-data" class="btn-secondary">üì§ Import Data</button>
                            <button id="clear-data" class="btn-danger">üóëÔ∏è Clear All Data</button>
                        </div>
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìñ Habit Tracker Help Guide</h2>
                <button id="close-help" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <!-- Getting Started -->
                    <section class="help-section">
                        <h3>üöÄ Getting Started</h3>
                        <p>Habit Tracker is a powerful tool for building and maintaining daily habits. Here's how to get started:</p>
                        <ol>
                            <li><strong>Add Your First Habit:</strong> Go to Settings ‚Üí "Add New Habit" and create your first habit</li>
                            <li><strong>Track Daily:</strong> Visit the Habits tab daily and click on habits to mark them complete</li>
                            <li><strong>View Progress:</strong> Check the Dashboard to see your progress over time</li>
                        </ol>
                    </section>

                    <!-- Features Overview -->
                    <section class="help-section">
                        <h3>‚ú® Features Overview</h3>
                        
                        <h4>üìÖ Habits Page</h4>
                        <ul>
                            <li><strong>Daily Tracking:</strong> Click habits to mark them complete for today</li>
                            <li><strong>Habit Matrix:</strong> View your last 7 or 30 days at a glance</li>
                            <li><strong>Visual Indicators:</strong> Completed habits show with checkmarks</li>
                            <li><strong>Start Dates:</strong> Habits can have custom start dates</li>
                        </ul>

                        <h4>üìä Dashboard Page</h4>
                        <ul>
                            <li><strong>Activity Overview:</strong> GitHub-style contribution grid showing your consistency</li>
                            <li><strong>Completion Rates:</strong> Track your daily, weekly, and monthly completion percentages</li>
                            <li><strong>Analytics Charts:</strong> Visual representations of your progress</li>
                            <li><strong>Habit Distribution:</strong> See how your completion rates are distributed</li>
                        </ul>

                        <h4>‚öôÔ∏è Settings Page</h4>
                        <ul>
                            <li><strong>Habit Management:</strong> Add, edit, or delete habits</li>
                            <li><strong>Customization:</strong> Choose colors and descriptions for each habit</li>
                            <li><strong>Demo Mode:</strong> Try the app with sample data</li>
                            <li><strong>Data Management:</strong> Export, import, or clear your data</li>
                        </ul>
                    </section>

                    <!-- How It Works -->
                    <section class="help-section">
                        <h3>üîß How It Works</h3>
                        
                        <h4>Smart Completion Logic</h4>
                        <p>The app uses intelligent completion rate calculations:</p>
                        <ul>
                            <li><strong>Active Habits Only:</strong> Completion rates are calculated based on habits that were active on each specific date</li>
                            <li><strong>Start Date Awareness:</strong> New habits don't lower historical completion rates</li>
                            <li><strong>Daily Accuracy:</strong> Each day's rate reflects only the habits you could have completed that day</li>
                        </ul>

                        <h4>Data Storage</h4>
                        <ul>
                            <li><strong>Local Storage:</strong> All data is stored locally in your browser</li>
                            <li><strong>No Server Required:</strong> Your data never leaves your device</li>
                            <li><strong>Export/Import:</strong> Backup your data as JSON files</li>
                            <li><strong>Persistent:</strong> Data remains even after closing the browser</li>
                        </ul>

                        <h4>Demo Mode</h4>
                        <p>Demo Mode lets you explore the app with sample data:</p>
                        <ul>
                            <li><strong>Data Preservation:</strong> Your current data is automatically backed up</li>
                            <li><strong>Sample Habits:</strong> 6 realistic habits with year-long completion data</li>
                            <li><strong>Realistic Patterns:</strong> Different completion rates and weekly variations</li>
                            <li><strong>Safe Restoration:</strong> Exit demo mode to restore your original data</li>
                        </ul>
                    </section>

                    <!-- Tips & Best Practices -->
                    <section class="help-section">
                        <h3>üí° Tips & Best Practices</h3>
                        
                        <h4>Building Effective Habits</h4>
                        <ul>
                            <li><strong>Start Small:</strong> Begin with 2-3 simple habits</li>
                            <li><strong>Be Consistent:</strong> Try to track every day, even if you miss some habits</li>
                            <li><strong>Use Start Dates:</strong> Set future start dates for habits you're not ready to begin</li>
                            <li><strong>Review Progress:</strong> Check the Dashboard weekly to see patterns</li>
                        </ul>

                        <h4>Using the App Effectively</h4>
                        <ul>
                            <li><strong>Daily Routine:</strong> Make habit tracking part of your morning or evening routine</li>
                            <li><strong>Keyboard Shortcuts:</strong> Use Alt+1, Alt+2, Alt+3 to quickly switch between pages</li>
                            <li><strong>Mobile Friendly:</strong> The app works great on mobile devices</li>
                            <li><strong>Regular Backups:</strong> Export your data regularly for safekeeping</li>
                        </ul>
                    </section>

                    <!-- Technical Details -->
                    <section class="help-section">
                        <h3>‚öôÔ∏è Technical Details</h3>
                        
                        <h4>Browser Compatibility</h4>
                        <ul>
                            <li>Works on all modern browsers (Chrome, Firefox, Safari, Edge)</li>
                            <li>Requires JavaScript and localStorage support</li>
                            <li>Responsive design works on desktop, tablet, and mobile</li>
                        </ul>

                        <h4>Data Structure</h4>
                        <ul>
                            <li><strong>Habits:</strong> ID, name, description, color, creation date, start date, active status</li>
                            <li><strong>Entries:</strong> Habit ID, date, completion status, notes</li>
                            <li><strong>Settings:</strong> Theme preferences, demo mode status, notification settings</li>
                        </ul>

                        <h4>Privacy & Security</h4>
                        <ul>
                            <li><strong>100% Private:</strong> No data is sent to any servers</li>
                            <li><strong>Local Only:</strong> All data stays in your browser</li>
                            <li><strong>No Tracking:</strong> No analytics or tracking scripts</li>
                            <li><strong>Open Source:</strong> Built with vanilla HTML, CSS, and JavaScript</li>
                        </ul>
                    </section>

                    <!-- Troubleshooting -->
                    <section class="help-section">
                        <h3>üîß Troubleshooting</h3>
                        
                        <h4>Common Issues</h4>
                        <ul>
                            <li><strong>Habits Not Showing:</strong> Try refreshing the page or checking if habits are active</li>
                            <li><strong>Data Not Saving:</strong> Ensure localStorage is enabled in your browser</li>
                            <li><strong>Dashboard Empty:</strong> Add some habits and track them for a few days</li>
                            <li><strong>Import Issues:</strong> Verify the JSON file format is correct</li>
                        </ul>

                        <h4>Getting Help</h4>
                        <ul>
                            <li><strong>Clear Data:</strong> Use "Clear All Data" if the app behaves unexpectedly</li>
                            <li><strong>Browser Cache:</strong> Try clearing browser cache if issues persist</li>
                            <li><strong>Export First:</strong> Always export data before clearing to avoid data loss</li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="scripts/storage.js"></script>
    <script src="scripts/habits.js"></script>
    <script src="scripts/dashboard.js"></script>
    <script src="scripts/settings.js"></script>
    <script src="scripts/app.js"></script>
</body>
</html>